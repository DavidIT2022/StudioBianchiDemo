<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studio Bianchi - Dataset Didattico | Star Schema Kimball</title>
    <meta name="description" content="Dataset didattico per corsi di Business Intelligence. Modello Star Schema Kimball per uno studio professionale.">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --accent: #0891b2;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --purple: #7c3aed;
            --bg-light: #ffffff;
            --bg-subtle: #f8fafc;
            --surface: #ffffff;
            --surface-alt: #f1f5f9;
            --text: #0f172a;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-light);
            color: var(--text);
            line-height: 1.7;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-weight: 700;
            font-size: 1rem;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo i { color: var(--primary); }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover { color: var(--primary); }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 6rem 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 900px;
        }

        .hero h1 {
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: 800;
            margin-bottom: 1rem;
            line-height: 1.1;
        }

        .hero h1 .accent { color: #38bdf8; }

        .hero .subtitle {
            font-size: 1.25rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }

        .hero p {
            font-size: clamp(1.1rem, 3vw, 1.35rem);
            color: #cbd5e1;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 3rem;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #38bdf8;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            animation: bounce 2s infinite;
        }

        .scroll-indicator i {
            font-size: 1.5rem;
            color: #64748b;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(-10px); }
            60% { transform: translateX(-50%) translateY(-5px); }
        }

        /* Sections */
        .section {
            padding: 5rem 1.5rem;
        }

        .section-alt { background: var(--bg-subtle); }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-number {
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .section h2 {
            font-size: clamp(1.75rem, 5vw, 2.5rem);
            font-weight: 800;
            margin-bottom: 1rem;
        }

        .section h2 .accent {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-lead {
            font-size: 1.1rem;
            color: var(--text-muted);
            max-width: 700px;
            margin: 0 auto;
        }

        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, #eff6ff 0%, #f0fdfa 100%);
            border: 1px solid #bfdbfe;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .info-box.warning {
            background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
            border-color: #fcd34d;
        }

        .info-box.success {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-color: #6ee7b7;
        }

        .info-box-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .info-box-title i { color: var(--primary); }
        .info-box.warning .info-box-title i { color: var(--warning); }
        .info-box.success .info-box-title i { color: var(--success); }

        .info-box p {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.6;
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
            border-color: var(--primary);
        }

        .card.clickable::after {
            content: "\f35d";
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: var(--primary);
            opacity: 0.4;
            font-size: 0.8rem;
        }

        .card.clickable:hover::after {
            opacity: 1;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .card-icon.purple { background: linear-gradient(135deg, var(--purple), #a855f7); }
        .card-icon.green { background: linear-gradient(135deg, var(--success), #34d399); }
        .card-icon.orange { background: linear-gradient(135deg, var(--warning), #fbbf24); }

        .card h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .card p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Schema Diagram SVG */
        .schema-container {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            overflow-x: auto;
        }

        .schema-svg {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            display: block;
        }

        .schema-svg .dim-box {
            fill: #dbeafe;
            stroke: #2563eb;
            stroke-width: 2;
            rx: 8;
        }

        .schema-svg .fact-box {
            fill: #d1fae5;
            stroke: #059669;
            stroke-width: 2;
            rx: 8;
        }

        .schema-svg .scd-box {
            fill: #fef3c7;
            stroke: #d97706;
            stroke-width: 2;
            rx: 8;
        }

        .schema-svg text {
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            fill: #1e293b;
        }

        .schema-svg .title {
            font-weight: 700;
            font-size: 13px;
        }

        .schema-svg .subtitle {
            font-size: 10px;
            fill: #64748b;
        }

        .schema-svg .measure {
            font-size: 9px;
            fill: #64748b;
            font-family: 'JetBrains Mono', monospace;
        }

        .schema-svg line {
            stroke: #94a3b8;
            stroke-width: 1.5;
        }

        .schema-svg .arrow {
            fill: #94a3b8;
        }

        /* Concept Cards */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .concept-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }

        .concept-header {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 1.25rem 1.5rem;
        }

        .concept-header h3 {
            font-size: 1.1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .concept-body {
            padding: 1.5rem;
        }

        .concept-body p {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .concept-body ul {
            list-style: none;
            padding: 0;
        }

        .concept-body li {
            font-size: 0.875rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .concept-body li:last-child {
            border-bottom: none;
        }

        .concept-body li i {
            color: var(--success);
            margin-top: 0.2rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-top: 2rem;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--surface-alt);
            font-weight: 600;
            color: var(--text);
            position: sticky;
            top: 0;
        }

        tr:hover { background: var(--bg-subtle); }

        .badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-blue { background: #dbeafe; color: #1d4ed8; }
        .badge-green { background: #d1fae5; color: #059669; }
        .badge-orange { background: #fef3c7; color: #d97706; }
        .badge-purple { background: #ede9fe; color: #7c3aed; }

        /* Code Block */
        .code-block {
            background: #1e293b;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            overflow-x: auto;
        }

        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: #e2e8f0;
            line-height: 1.6;
            white-space: pre;
        }

        .code-block .comment { color: #64748b; }
        .code-block .keyword { color: #38bdf8; }
        .code-block .string { color: #4ade80; }
        .code-block .function { color: #c084fc; }

        /* API Section */
        .api-endpoint {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s ease;
        }

        .api-endpoint:hover {
            border-color: var(--primary);
            background: var(--bg-subtle);
        }

        .api-method {
            padding: 0.25rem 0.5rem;
            background: #d1fae5;
            color: #059669;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .api-path {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text);
            flex: 1;
        }

        .api-path a {
            color: var(--primary);
            text-decoration: none;
        }

        .api-path a:hover { text-decoration: underline; }

        .api-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 2rem;
            margin-top: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, var(--primary), var(--accent));
        }

        .timeline-item {
            position: relative;
            padding-bottom: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2rem;
            top: 0.25rem;
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: var(--shadow);
        }

        .timeline-item h4 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .timeline-item p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 {
            font-size: 1.25rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .modal-header h3 i {
            color: var(--primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.25rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--surface-alt);
            color: var(--text);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-body h4 {
            font-size: 1rem;
            font-weight: 700;
            margin: 1.5rem 0 0.75rem;
            color: var(--primary);
        }

        .modal-body h4:first-child {
            margin-top: 0;
        }

        .modal-body p {
            font-size: 0.95rem;
            color: var(--text);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .modal-body ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .modal-body li {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .modal-body code {
            background: var(--surface-alt);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }

        /* Quote */
        .quote {
            background: linear-gradient(135deg, #eff6ff 0%, #f0fdfa 100%);
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }

        .quote p {
            font-style: italic;
            font-size: 1.1rem;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .quote cite {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-style: normal;
        }

        /* Footer */
        .footer {
            background: #0f172a;
            color: #94a3b8;
            padding: 3rem 1.5rem;
            text-align: center;
        }

        .footer p { font-size: 0.875rem; }
        .footer a { color: #38bdf8; text-decoration: none; }
        .footer a:hover { text-decoration: underline; }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .hero-stats { gap: 1.5rem; }
            .stat-value { font-size: 2rem; }
            .concept-grid { grid-template-columns: 1fr; }
        }

        /* Reveal Animation */
        .reveal {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }

        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            cursor: help;
            border-bottom: 1px dashed var(--text-muted);
        }

        .tooltip:hover::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            white-space: nowrap;
            z-index: 100;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border);
            margin-bottom: 1.5rem;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            color: var(--primary);
        }

        .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-database"></i>
            Studio Bianchi Dataset
        </div>
        <nav class="nav-links">
            <a href="#caso">Il Caso</a>
            <a href="#kimball">Metodologia Kimball</a>
            <a href="#modello">Star Schema</a>
            <a href="#viste">Viste SQL</a>
            <a href="#api">API JSON</a>
        </nav>
    </header>

    <!-- Hero -->
    <section class="hero">
        <div class="hero-content">
            <div class="subtitle">Dataset Didattico per Business Intelligence</div>
            <h1>Studio <span class="accent">Bianchi</span></h1>
            <p>Impara a costruire un Data Warehouse con il metodo Kimball attraverso un caso realistico di uno studio professionale italiano.</p>

            <div class="hero-stats">
                <div class="stat">
                    <div class="stat-value">31</div>
                    <div class="stat-label">Viste SQL</div>
                </div>
                <div class="stat">
                    <div class="stat-value">7</div>
                    <div class="stat-label">Dimensioni</div>
                </div>
                <div class="stat">
                    <div class="stat-value">4</div>
                    <div class="stat-label">Fact Tables</div>
                </div>
                <div class="stat">
                    <div class="stat-value">16K+</div>
                    <div class="stat-label">Transazioni</div>
                </div>
            </div>
        </div>
        <div class="scroll-indicator">
            <i class="fas fa-chevron-down"></i>
        </div>
    </section>

    <!-- Il Caso -->
    <section id="caso" class="section">
        <div class="container">
            <div class="section-header">
                <div class="section-number">Capitolo 01</div>
                <h2>Il Caso <span class="accent">Studio Bianchi</span></h2>
                <p class="section-lead">Uno studio professionale realistico che affronta le sfide tipiche dell'analisi della redditività dei servizi professionali.</p>
            </div>

            <div class="quote reveal">
                <p>"Come faccio a sapere se un incarico è stato profittevole, considerando che le persone cambiano ruolo e costo nel tempo?"</p>
                <cite>— La domanda che ha guidato la progettazione del modello</cite>
            </div>

            <div class="cards-grid">
                <div class="card clickable reveal" onclick="openModal('modal-contesto')">
                    <div class="card-icon"><i class="fas fa-building"></i></div>
                    <h3>Il Contesto</h3>
                    <p>Studio professionale con 12 collaboratori organizzati in 3 team che offre servizi di consulenza contabile, fiscale e revisione.</p>
                </div>
                <div class="card clickable reveal" onclick="openModal('modal-problema')">
                    <div class="card-icon orange"><i class="fas fa-puzzle-piece"></i></div>
                    <h3>Il Problema</h3>
                    <p>Calcolare la redditività degli incarichi considerando che i costi orari cambiano nel tempo e gli incarichi sono a forfait.</p>
                </div>
                <div class="card clickable reveal" onclick="openModal('modal-dati')">
                    <div class="card-icon green"><i class="fas fa-table"></i></div>
                    <h3>I Dati</h3>
                    <p>Due anni di timesheet, 250 incarichi, storico completo di ruoli, costi e appartenenze ai team delle persone.</p>
                </div>
                <div class="card clickable reveal" onclick="openModal('modal-obiettivo')">
                    <div class="card-icon purple"><i class="fas fa-bullseye"></i></div>
                    <h3>L'Obiettivo</h3>
                    <p>Confrontare il margine reale (ricavo pattuito - costi) con il margine desiderato (se vendessimo a tariffa piena).</p>
                </div>
            </div>

            <div class="info-box reveal" style="margin-top: 2rem;">
                <div class="info-box-title"><i class="fas fa-lightbulb"></i> Perché questo caso è formativo?</div>
                <p>Il caso Studio Bianchi presenta problematiche reali che si incontrano nei progetti di BI: <strong>slowly changing dimensions</strong> (le persone cambiano ruolo/costo), <strong>granularità diverse</strong> (ricavo a incarico vs costi a ora), <strong>role-playing dimensions</strong> (stesso team con ruoli diversi). È un ottimo esercizio per padroneggiare la metodologia Kimball.</p>
            </div>
        </div>
    </section>

    <!-- Metodologia Kimball -->
    <section id="kimball" class="section section-alt">
        <div class="container">
            <div class="section-header">
                <div class="section-number">Capitolo 02</div>
                <h2>La Metodologia <span class="accent">Kimball</span></h2>
                <p class="section-lead">Ralph Kimball ha definito l'approccio standard per la progettazione di Data Warehouse orientati all'analisi.</p>
            </div>

            <div class="quote reveal">
                <p>"Il data warehouse deve essere progettato partendo dai requisiti di business, non dalla struttura dei sistemi sorgente."</p>
                <cite>— Ralph Kimball, "The Data Warehouse Toolkit"</cite>
            </div>

            <div class="concept-grid">
                <div class="concept-card reveal">
                    <div class="concept-header">
                        <h3><i class="fas fa-star"></i> Star Schema</h3>
                    </div>
                    <div class="concept-body">
                        <p>Il modello a stella è la struttura fondamentale: una <strong>fact table</strong> centrale circondata da <strong>dimension tables</strong>.</p>
                        <ul>
                            <li><i class="fas fa-check"></i> <strong>Fact Table:</strong> contiene le misure numeriche (fatti) e le chiavi esterne alle dimensioni</li>
                            <li><i class="fas fa-check"></i> <strong>Dimension Table:</strong> contiene gli attributi descrittivi per filtrare e raggruppare</li>
                            <li><i class="fas fa-check"></i> <strong>Perché:</strong> ottimizza le query analitiche e semplifica la comprensione del modello</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card reveal">
                    <div class="concept-header" style="background: linear-gradient(135deg, #d97706, #f59e0b);">
                        <h3><i class="fas fa-history"></i> SCD Type 2</h3>
                    </div>
                    <div class="concept-body">
                        <p>Le <strong>Slowly Changing Dimensions</strong> gestiscono gli attributi che cambiano nel tempo mantenendo la storia.</p>
                        <ul>
                            <li><i class="fas fa-check"></i> <strong>Type 1:</strong> sovrascrive il vecchio valore (nessuna storia)</li>
                            <li><i class="fas fa-check"></i> <strong>Type 2:</strong> crea una nuova riga per ogni cambio con ValidoDa/ValidoA</li>
                            <li><i class="fas fa-check"></i> <strong>Nel nostro caso:</strong> Dim_Persona usa SCD2 per tracciare ruolo, costo e team nel tempo</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card reveal">
                    <div class="concept-header" style="background: linear-gradient(135deg, #7c3aed, #a855f7);">
                        <h3><i class="fas fa-key"></i> Surrogate Keys</h3>
                    </div>
                    <div class="concept-body">
                        <p>Chiavi artificiali che identificano univocamente ogni riga, indipendenti dai sistemi sorgente.</p>
                        <ul>
                            <li><i class="fas fa-check"></i> <strong>DataKey:</strong> formato YYYYMMDD (es. 20240115) invece di DATE</li>
                            <li><i class="fas fa-check"></i> <strong>PersonaSK:</strong> chiave surrogata che cambia ad ogni versione SCD2</li>
                            <li><i class="fas fa-check"></i> <strong>Perché:</strong> performance migliori (integer vs date) e indipendenza dai sorgenti</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card reveal">
                    <div class="concept-header" style="background: linear-gradient(135deg, #059669, #34d399);">
                        <h3><i class="fas fa-compress-alt"></i> Denormalizzazione</h3>
                    </div>
                    <div class="concept-body">
                        <p>Le dimensioni includono attributi da più tabelle sorgente per ridurre i join.</p>
                        <ul>
                            <li><i class="fas fa-check"></i> <strong>Dim_Incarico:</strong> include ClienteRagioneSociale e TipoIncaricoDescrizione</li>
                            <li><i class="fas fa-check"></i> <strong>Dim_Persona:</strong> include NomeTeam dalla tabella Team</li>
                            <li><i class="fas fa-check"></i> <strong>Perché:</strong> query più semplici e performanti, modello più intuitivo</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="info-box warning reveal" style="margin-top: 2rem;">
                <div class="info-box-title"><i class="fas fa-exclamation-triangle"></i> Attenzione: Granularità</div>
                <p>La <strong>granularità</strong> della fact table è la decisione più importante. Nel nostro caso: <code>Fact_Timesheet</code> ha granularità "una riga per ogni registrazione di ore" mentre <code>Fact_Redditivita_Incarico</code> ha granularità "una riga per incarico". Non mischiarle mai nella stessa fact table!</p>
            </div>
        </div>
    </section>

    <!-- Star Schema -->
    <section id="modello" class="section">
        <div class="container">
            <div class="section-header">
                <div class="section-number">Capitolo 03</div>
                <h2>Lo <span class="accent">Star Schema</span></h2>
                <p class="section-lead">Il modello dimensionale progettato per rispondere alle domande di business dello Studio Bianchi.</p>
            </div>

            <div class="schema-container reveal">
                <svg class="schema-svg" viewBox="0 0 900 550" xmlns="http://www.w3.org/2000/svg">
                    <!-- Dim_Data -->
                    <rect class="dim-box" x="370" y="20" width="160" height="70"/>
                    <text x="450" y="50" text-anchor="middle" class="title">Dim_Data</text>
                    <text x="450" y="70" text-anchor="middle" class="subtitle">DataKey (YYYYMMDD)</text>

                    <!-- Lines from Dim_Data -->
                    <line x1="410" y1="90" x2="150" y2="160"/>
                    <line x1="450" y1="90" x2="450" y2="160"/>
                    <line x1="490" y1="90" x2="750" y2="160"/>

                    <!-- Fact_Timesheet -->
                    <rect class="fact-box" x="50" y="160" width="200" height="160"/>
                    <text x="150" y="190" text-anchor="middle" class="title">Fact_Timesheet</text>
                    <text x="150" y="210" text-anchor="middle" class="subtitle">(transactional)</text>
                    <text x="70" y="240" class="measure">• OreLavorate</text>
                    <text x="70" y="258" class="measure">• CostoEffettivo</text>
                    <text x="70" y="276" class="measure">• RicavoTeoricoRivendita</text>
                    <text x="70" y="294" class="measure">• MargineTeoricoRivendita</text>
                    <text x="70" y="312" class="measure">• GiornateEquivalenti</text>

                    <!-- Fact_Redditivita -->
                    <rect class="fact-box" x="350" y="160" width="200" height="160"/>
                    <text x="450" y="190" text-anchor="middle" class="title">Fact_Redditivita_Incarico</text>
                    <text x="450" y="210" text-anchor="middle" class="subtitle">(accumulating snapshot)</text>
                    <text x="370" y="240" class="measure">• RicavoReale (pattuito)</text>
                    <text x="370" y="258" class="measure">• RicavoTeorico (ore×tariffa)</text>
                    <text x="370" y="276" class="measure">• CostoTotale</text>
                    <text x="370" y="294" class="measure">• MargineReale</text>
                    <text x="370" y="312" class="measure">• MargineDesiderato</text>

                    <!-- Fact_CostiDiretti -->
                    <rect class="fact-box" x="650" y="160" width="200" height="100"/>
                    <text x="750" y="190" text-anchor="middle" class="title">Fact_CostiDiretti</text>
                    <text x="750" y="210" text-anchor="middle" class="subtitle">(transactional)</text>
                    <text x="670" y="240" class="measure">• Importo</text>

                    <!-- Dim_Persona (SCD2) -->
                    <rect class="scd-box" x="100" y="400" width="180" height="80"/>
                    <text x="190" y="430" text-anchor="middle" class="title">Dim_Persona</text>
                    <text x="190" y="450" text-anchor="middle" class="subtitle">SCD Type 2</text>
                    <text x="190" y="470" text-anchor="middle" class="measure">PersonaSK, ValidoDa/A</text>

                    <!-- Dim_Incarico -->
                    <rect class="dim-box" x="360" y="400" width="180" height="80"/>
                    <text x="450" y="430" text-anchor="middle" class="title">Dim_Incarico</text>
                    <text x="450" y="450" text-anchor="middle" class="subtitle">denormalizzata</text>
                    <text x="450" y="470" text-anchor="middle" class="measure">+ Cliente, TipoIncarico</text>

                    <!-- Dim_Team -->
                    <rect class="dim-box" x="620" y="400" width="180" height="80"/>
                    <text x="710" y="430" text-anchor="middle" class="title">Dim_Team</text>
                    <text x="710" y="450" text-anchor="middle" class="subtitle">role-playing</text>
                    <text x="710" y="470" text-anchor="middle" class="measure">Prestatore / Titolare</text>

                    <!-- Lines to dimensions -->
                    <line x1="150" y1="320" x2="190" y2="400"/>
                    <line x1="150" y1="320" x2="450" y2="400"/>
                    <line x1="150" y1="320" x2="710" y2="400"/>

                    <line x1="450" y1="320" x2="190" y2="400" stroke-dasharray="5,5"/>
                    <line x1="450" y1="320" x2="450" y2="400"/>
                    <line x1="450" y1="320" x2="710" y2="400" stroke-dasharray="5,5"/>

                    <line x1="750" y1="260" x2="450" y2="400"/>
                    <line x1="750" y1="260" x2="710" y2="400"/>

                    <!-- Legend -->
                    <rect x="30" y="510" width="15" height="15" fill="#dbeafe" stroke="#2563eb"/>
                    <text x="50" y="522" font-size="11">Dimensione</text>

                    <rect x="130" y="510" width="15" height="15" fill="#d1fae5" stroke="#059669"/>
                    <text x="150" y="522" font-size="11">Fact Table</text>

                    <rect x="230" y="510" width="15" height="15" fill="#fef3c7" stroke="#d97706"/>
                    <text x="250" y="522" font-size="11">SCD Type 2</text>

                    <line x1="350" y1="517" x2="400" y2="517" stroke-dasharray="5,5" stroke="#94a3b8" stroke-width="2"/>
                    <text x="410" y="522" font-size="11">FK opzionale</text>
                </svg>
            </div>

            <h3 style="margin-top: 3rem; margin-bottom: 1rem;"><i class="fas fa-info-circle" style="color: var(--primary);"></i> Spiegazione delle Scelte Progettuali</h3>

            <div class="timeline reveal">
                <div class="timeline-item">
                    <h4>Perché due Fact Table per i ricavi?</h4>
                    <p><strong>Fact_Timesheet</strong> ha granularità "registrazione ore" e contiene il <em>ricavo teorico</em> (ore × tariffa oraria storicizzata). <strong>Fact_Redditivita_Incarico</strong> ha granularità "incarico" e contiene il <em>ricavo reale</em> (importo pattuito a forfait). Non possiamo mettere l'importo pattuito nella Fact_Timesheet perché violerebbe la regola della granularità!</p>
                </div>
                <div class="timeline-item">
                    <h4>Perché Dim_Persona con SCD Type 2?</h4>
                    <p>Una persona può cambiare ruolo (es. da Senior a Manager), costo orario (aumento annuale) e team (trasferimento). Con SCD2, ogni versione ha una riga separata con <code>ValidoDa</code>/<code>ValidoA</code>. Quando calcoliamo il costo di un timesheet del 2024, usiamo automaticamente il costo che quella persona aveva nel 2024, non quello attuale.</p>
                </div>
                <div class="timeline-item">
                    <h4>Perché Dim_Team come Role-Playing?</h4>
                    <p>Nella Fact_Timesheet, il team appare due volte: <strong>TeamPrestatoreID</strong> (il team a cui appartiene chi ha lavorato) e <strong>TeamTitolareID</strong> (il team responsabile dell'incarico). Sono la stessa dimensione usata in due ruoli diversi. Questo permette analisi come "ore del team Fiscale prestate su incarichi del team Revisione".</p>
                </div>
                <div class="timeline-item">
                    <h4>Perché denormalizzare Dim_Incarico?</h4>
                    <p>Invece di avere FK a Dim_Cliente e Dim_TipoIncarico, abbiamo incluso direttamente <code>ClienteRagioneSociale</code>, <code>ClienteSettore</code>, <code>TipoIncaricoDescrizione</code> nella dimensione. Questo semplifica le query e migliora le performance. È il classico trade-off Kimball: duplicazione controllata per semplicità d'uso.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Viste SQL -->
    <section id="viste" class="section section-alt">
        <div class="container">
            <div class="section-header">
                <div class="section-number">Capitolo 04</div>
                <h2>Le <span class="accent">Viste SQL</span></h2>
                <p class="section-lead">Due set di viste: le didattiche (replica delle trasformazioni M di Power Query) e le Star Schema (modello Kimball).</p>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="showTab('tab-star')">Star Schema (11)</button>
                <button class="tab-btn" onclick="showTab('tab-didattica')">Didattiche (20)</button>
            </div>

            <div id="tab-star" class="tab-content active">
                <div class="info-box success">
                    <div class="info-box-title"><i class="fas fa-star"></i> Viste Star Schema</div>
                    <p>Queste viste implementano il modello dimensionale Kimball. Usale per costruire dashboard analitiche in Power BI, Tableau o altri strumenti BI.</p>
                </div>

                <div class="table-container reveal">
                    <table>
                        <thead>
                            <tr>
                                <th>Vista</th>
                                <th>Tipo</th>
                                <th>Righe</th>
                                <th>Descrizione</th>
                                <th>Chiave</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr onclick="openModal('modal-dim-data')" style="cursor:pointer">
                                <td><code>Dim_Data</code></td>
                                <td><span class="badge badge-blue">DIM</span></td>
                                <td>731</td>
                                <td>Calendario con attributi temporali (anno, mese, trimestre, settimana ISO)</td>
                                <td><code>DataKey</code> (YYYYMMDD)</td>
                            </tr>
                            <tr onclick="openModal('modal-dim-persona')" style="cursor:pointer">
                                <td><code>Dim_Persona</code></td>
                                <td><span class="badge badge-blue">DIM</span> <span class="badge badge-orange">SCD2</span></td>
                                <td>32</td>
                                <td>Persone storicizzate con ruolo, costo orario, tariffa, team</td>
                                <td><code>PersonaSK</code></td>
                            </tr>
                            <tr>
                                <td><code>Dim_Team</code></td>
                                <td><span class="badge badge-blue">DIM</span></td>
                                <td>3</td>
                                <td>Team dello studio (Bilanci, Fiscale, Revisione)</td>
                                <td><code>TeamID</code></td>
                            </tr>
                            <tr>
                                <td><code>Dim_Cliente</code></td>
                                <td><span class="badge badge-blue">DIM</span></td>
                                <td>180</td>
                                <td>Anagrafica clienti con settore</td>
                                <td><code>ClienteID</code></td>
                            </tr>
                            <tr onclick="openModal('modal-dim-incarico')" style="cursor:pointer">
                                <td><code>Dim_Incarico</code></td>
                                <td><span class="badge badge-blue">DIM</span> <span class="badge badge-purple">DEORM</span></td>
                                <td>250</td>
                                <td>Incarichi con Cliente e TipoIncarico embedded</td>
                                <td><code>IncaricoID</code></td>
                            </tr>
                            <tr>
                                <td><code>Dim_TipoCosto</code></td>
                                <td><span class="badge badge-blue">DIM</span></td>
                                <td>10</td>
                                <td>Tipologie di costo diretto</td>
                                <td><code>TipoCostoID</code></td>
                            </tr>
                            <tr>
                                <td><code>Dim_VoceCapitolato</code></td>
                                <td><span class="badge badge-blue">DIM</span></td>
                                <td>64</td>
                                <td>Voci standard del capitolato per tipo incarico</td>
                                <td><code>VoceID</code></td>
                            </tr>
                            <tr onclick="openModal('modal-fact-timesheet')" style="cursor:pointer">
                                <td><code>Fact_Timesheet</code></td>
                                <td><span class="badge badge-green">FACT</span></td>
                                <td>16.248</td>
                                <td>Ore lavorate con costo e ricavo teorico storicizzato</td>
                                <td><code>TimesheetID</code></td>
                            </tr>
                            <tr onclick="openModal('modal-fact-redditivita')" style="cursor:pointer">
                                <td><code>Fact_Redditivita_Incarico</code></td>
                                <td><span class="badge badge-green">FACT</span></td>
                                <td>250</td>
                                <td>Margine reale vs desiderato per incarico</td>
                                <td><code>IncaricoID</code></td>
                            </tr>
                            <tr>
                                <td><code>Fact_CostiDiretti</code></td>
                                <td><span class="badge badge-green">FACT</span></td>
                                <td>244</td>
                                <td>Spese vive imputate agli incarichi</td>
                                <td><code>CostoDirettoID</code></td>
                            </tr>
                            <tr>
                                <td><code>Fact_AvanzamentoCapitolato</code></td>
                                <td><span class="badge badge-green">FACT</span></td>
                                <td>1.364</td>
                                <td>Stato di completamento delle voci capitolato</td>
                                <td><code>IncaricoID + VoceID</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="tab-didattica" class="tab-content">
                <div class="info-box">
                    <div class="info-box-title"><i class="fas fa-graduation-cap"></i> Viste Didattiche</div>
                    <p>Queste viste replicano le trasformazioni M di Power Query. Sono utili per capire come si passa dai dati grezzi alle strutture analitiche e per confrontare l'approccio SQL vs M.</p>
                </div>

                <div class="table-container reveal">
                    <table>
                        <thead>
                            <tr>
                                <th>Vista</th>
                                <th>Righe</th>
                                <th>Descrizione</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td><code>Calendario</code></td><td>6.209</td><td>Calendario generato con attributi temporali italiani</td></tr>
                            <tr><td><code>Persone</code></td><td>12</td><td>Anagrafica con colonna Nominativo calcolata</td></tr>
                            <tr><td><code>Persone_Contratto_Storico</code></td><td>23</td><td>Storico ruolo/FTE/ore con ValidoDa/ValidoA</td></tr>
                            <tr><td><code>Persone_Contratto_Giornaliero</code></td><td>36.995</td><td>Espansione giornaliera del contratto</td></tr>
                            <tr><td><code>Persone_Costo_Storico</code></td><td>24</td><td>Storico costo orario e tariffa</td></tr>
                            <tr><td><code>Persone_Costo_Giornaliero</code></td><td>24.772</td><td>Espansione giornaliera dei costi</td></tr>
                            <tr><td><code>Persone_Team_Storico</code></td><td>16</td><td>Storico appartenenza ai team</td></tr>
                            <tr><td><code>Persone_Team_Giornaliero</code></td><td>36.995</td><td>Espansione giornaliera team</td></tr>
                            <tr><td><code>Timesheet</code></td><td>16.248</td><td>Registrazioni ore con merge dati persona alla data</td></tr>
                            <tr><td><code>Incarichi</code></td><td>250</td><td>Incarichi con correzione date weekend</td></tr>
                            <tr><td><code>Incarichi_Capitolato</code></td><td>1.364</td><td>Voci capitolato per ogni incarico</td></tr>
                            <tr><td><code>CostiDiretti</code></td><td>244</td><td>Spese vive</td></tr>
                            <tr><td><code>Clienti</code></td><td>180</td><td>Anagrafica clienti</td></tr>
                            <tr><td><code>Team</code></td><td>3</td><td>Struttura team</td></tr>
                            <tr><td><code>TipiIncarico</code></td><td>12</td><td>Tipologie di incarico</td></tr>
                            <tr><td><code>VociCapitolato</code></td><td>64</td><td>Template voci capitolato</td></tr>
                            <tr><td><code>TipiCostoDiretto</code></td><td>10</td><td>Categorie costi diretti</td></tr>
                            <tr><td><code>CentriDiCosto</code></td><td>5</td><td>Centri di costo</td></tr>
                            <tr><td><code>CentriCosto_Costi</code></td><td>120</td><td>Allocazione costi ai centri</td></tr>
                            <tr><td><code>Ruoli</code></td><td>4</td><td>Lista ruoli distinti (estratta da contratti)</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- API JSON -->
    <section id="api" class="section">
        <div class="container">
            <div class="section-header">
                <div class="section-number">Capitolo 05</div>
                <h2>Connessione <span class="accent">API JSON</span></h2>
                <p class="section-lead">Tutti i dati sono disponibili come file JSON statici. Connettiti da Power BI, Python, o qualsiasi strumento che legge JSON via HTTP.</p>
            </div>

            <div class="info-box success reveal">
                <div class="info-box-title"><i class="fas fa-globe"></i> Nessun problema di firewall!</div>
                <p>I file sono hostati su GitHub Pages (HTTPS, porta 443). Funzionano da qualsiasi rete, anche con firewall restrittivi. Ideale per corsi dove gli studenti hanno configurazioni di rete diverse.</p>
            </div>

            <h3 style="margin-top: 2rem; margin-bottom: 1rem;"><i class="fas fa-star" style="color: var(--warning);"></i> Star Schema</h3>

            <div class="reveal">
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Dim_Data.json" target="_blank">data/starschema/Dim_Data.json</a></span>
                    <span class="api-desc">332 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Dim_Persona.json" target="_blank">data/starschema/Dim_Persona.json</a></span>
                    <span class="api-desc">15 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Dim_Incarico.json" target="_blank">data/starschema/Dim_Incarico.json</a></span>
                    <span class="api-desc">121 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Dim_Cliente.json" target="_blank">data/starschema/Dim_Cliente.json</a></span>
                    <span class="api-desc">20 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Dim_Team.json" target="_blank">data/starschema/Dim_Team.json</a></span>
                    <span class="api-desc">0.3 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Fact_Timesheet.json" target="_blank">data/starschema/Fact_Timesheet.json</a></span>
                    <span class="api-desc">6.7 MB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Fact_Redditivita_Incarico.json" target="_blank">data/starschema/Fact_Redditivita_Incarico.json</a></span>
                    <span class="api-desc">174 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Fact_CostiDiretti.json" target="_blank">data/starschema/Fact_CostiDiretti.json</a></span>
                    <span class="api-desc">38 KB</span>
                </div>
                <div class="api-endpoint">
                    <span class="api-method">GET</span>
                    <span class="api-path"><a href="data/starschema/Fact_AvanzamentoCapitolato.json" target="_blank">data/starschema/Fact_AvanzamentoCapitolato.json</a></span>
                    <span class="api-desc">370 KB</span>
                </div>
            </div>

            <h3 style="margin-top: 2rem; margin-bottom: 1rem;"><i class="fas fa-code" style="color: var(--primary);"></i> Come connettersi da Power BI</h3>

            <div class="code-block reveal">
                <code><span class="comment">// Power Query M - Esempio per Fact_Timesheet</span>
<span class="keyword">let</span>
    <span class="comment">// 1. Scarica il JSON dalla URL</span>
    Source = Json.Document(Web.Contents(
        <span class="string">"https://davidit2022.github.io/StudioBianchiDemo/data/starschema/Fact_Timesheet.json"</span>
    )),

    <span class="comment">// 2. Converti la lista di record in tabella</span>
    ToTable = Table.FromList(Source, Splitter.SplitByNothing(), <span class="keyword">null</span>, <span class="keyword">null</span>, ExtraValues.Error),

    <span class="comment">// 3. Espandi tutti i campi del record</span>
    Expanded = Table.ExpandRecordColumn(ToTable, <span class="string">"Column1"</span>, Record.FieldNames(ToTable{0}[Column1]))
<span class="keyword">in</span>
    Expanded</code>
            </div>

            <div class="info-box reveal" style="margin-top: 1.5rem;">
                <div class="info-box-title"><i class="fas fa-lightbulb"></i> Suggerimento</div>
                <p>Crea una <strong>funzione parametrica</strong> in Power Query che accetta il nome del file come parametro. Così potrai caricare tutte le tabelle con la stessa logica, cambiando solo il nome.</p>
            </div>

            <h3 style="margin-top: 2rem; margin-bottom: 1rem;"><i class="fas fa-python" style="color: var(--warning);"></i> Come connettersi da Python</h3>

            <div class="code-block reveal">
                <code><span class="keyword">import</span> pandas <span class="keyword">as</span> pd

<span class="comment"># Carica direttamente da URL</span>
base_url = <span class="string">"https://davidit2022.github.io/StudioBianchiDemo/data/starschema/"</span>

fact_timesheet = pd.<span class="function">read_json</span>(base_url + <span class="string">"Fact_Timesheet.json"</span>)
dim_persona = pd.<span class="function">read_json</span>(base_url + <span class="string">"Dim_Persona.json"</span>)
dim_data = pd.<span class="function">read_json</span>(base_url + <span class="string">"Dim_Data.json"</span>)

<span class="comment"># Analisi esempio: margine per persona</span>
margini = fact_timesheet.groupby(<span class="string">'PersonaID'</span>).agg({
    <span class="string">'CostoEffettivo'</span>: <span class="string">'sum'</span>,
    <span class="string">'RicavoTeoricoRivendita'</span>: <span class="string">'sum'</span>
})
<span class="function">print</span>(margini)</code>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p style="font-size: 1.1rem; margin-bottom: 1rem;"><i class="fas fa-database"></i> <strong>Studio Bianchi Dataset</strong></p>
            <p>Materiale didattico per corsi di Business Intelligence</p>
            <p style="margin-top: 1rem;">
                Repository: <a href="https://github.com/DavidIT2022/StudioBianchiDemo" target="_blank"><i class="fab fa-github"></i> github.com/DavidIT2022/StudioBianchiDemo</a>
            </p>
            <p style="margin-top: 1rem; font-size: 0.8rem; color: #64748b;">
                Modello Star Schema progettato secondo la metodologia Kimball
            </p>
        </div>
    </footer>

    <!-- Modals -->

    <!-- Modal: Contesto -->
    <div class="modal-overlay" id="modal-contesto">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-building"></i> Il Contesto: Studio Bianchi</h3>
                <button class="modal-close" onclick="closeModal('modal-contesto')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Lo Studio</h4>
                <p>Studio Bianchi è uno studio professionale italiano di medie dimensioni che offre servizi di consulenza a imprese. È organizzato in <strong>3 team specializzati</strong>:</p>
                <ul>
                    <li><strong>Bilanci e Contabilità:</strong> redazione bilanci, contabilità ordinaria, reporting</li>
                    <li><strong>Fiscale:</strong> dichiarazioni, pianificazione fiscale, contenziosi</li>
                    <li><strong>Revisione:</strong> revisione legale, due diligence, audit</li>
                </ul>

                <h4>Le Persone</h4>
                <p>Lo studio impiega <strong>12 professionisti</strong> con ruoli diversi:</p>
                <ul>
                    <li><strong>Junior:</strong> neo-inseriti, costo orario basso, tariffa contenuta</li>
                    <li><strong>Senior:</strong> esperienza consolidata, autonomia operativa</li>
                    <li><strong>Manager:</strong> coordinamento progetti, relazione con clienti</li>
                    <li><strong>Partner:</strong> titolari, responsabilità finale, tariffa premium</li>
                </ul>

                <h4>Il Modello di Business</h4>
                <p>Gli incarichi vengono <strong>venduti a forfait</strong> (importo pattuito fisso), ma i costi interni sono calcolati in base alle <strong>ore effettivamente lavorate</strong>. Questa differenza di granularità è una delle sfide principali del modello dati.</p>
            </div>
        </div>
    </div>

    <!-- Modal: Problema -->
    <div class="modal-overlay" id="modal-problema">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-puzzle-piece"></i> Il Problema di Business</h3>
                <button class="modal-close" onclick="closeModal('modal-problema')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>La Domanda Chiave</h4>
                <p>"<em>Quanto abbiamo guadagnato (o perso) su questo incarico, considerando il costo reale delle persone che ci hanno lavorato?</em>"</p>

                <h4>Perché è Complicato?</h4>
                <ul>
                    <li><strong>I costi cambiano nel tempo:</strong> una persona assunta a 30€/ora nel 2023 potrebbe costare 35€/ora nel 2024</li>
                    <li><strong>Le persone cambiano ruolo:</strong> un Junior promosso a Senior ha un costo diverso</li>
                    <li><strong>Le persone cambiano team:</strong> un trasferimento dal team Fiscale al team Revisione</li>
                    <li><strong>Gli incarichi durano mesi:</strong> un incarico iniziato a gennaio 2024 e finito a marzo 2025 attraversa più versioni di costo</li>
                </ul>

                <h4>Cosa Vogliamo Calcolare</h4>
                <ul>
                    <li><strong>Margine Reale:</strong> Importo Pattuito - Costo Effettivo delle Ore - Costi Diretti</li>
                    <li><strong>Margine Desiderato:</strong> (Ore × Tariffa Teorica) - Costo Effettivo</li>
                    <li><strong>Sconto Applicato:</strong> quanto abbiamo "scontato" rispetto alla tariffa piena</li>
                </ul>

                <h4>La Soluzione</h4>
                <p>Usare <strong>SCD Type 2</strong> per storicizzare i costi e le tariffe, così ogni ora lavorata viene valorizzata con il costo/tariffa corretti a quella data specifica.</p>
            </div>
        </div>
    </div>

    <!-- Modal: Dati -->
    <div class="modal-overlay" id="modal-dati">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-table"></i> I Dati Disponibili</h3>
                <button class="modal-close" onclick="closeModal('modal-dati')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Timesheet (16.248 registrazioni)</h4>
                <p>Due anni completi di registrazioni ore (2024-2025). Ogni riga rappresenta le ore lavorate da una persona su un incarico in un giorno specifico.</p>

                <h4>Incarichi (250)</h4>
                <p>Incarichi con 180 clienti diversi. Ogni incarico ha: data apertura, data chiusura (se completato), importo pattuito, tipo incarico, team titolare.</p>

                <h4>Storico Persone (3 dimensioni storiche)</h4>
                <ul>
                    <li><strong>Contratto:</strong> ruolo, FTE, ore lavorative giornaliere (23 versioni)</li>
                    <li><strong>Costo:</strong> costo orario, tariffa oraria (24 versioni)</li>
                    <li><strong>Team:</strong> appartenenza ai team (16 versioni)</li>
                </ul>

                <h4>Capitolato (1.364 voci)</h4>
                <p>Ogni tipo di incarico ha un capitolato standard con voci pesate. Tracciamo l'avanzamento (eseguito sì/no) per ogni voce di ogni incarico.</p>

                <h4>Costi Diretti (244)</h4>
                <p>Spese vive imputate agli incarichi: trasferte, consulenze esterne, software, etc.</p>
            </div>
        </div>
    </div>

    <!-- Modal: Obiettivo -->
    <div class="modal-overlay" id="modal-obiettivo">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-bullseye"></i> L'Obiettivo Analitico</h3>
                <button class="modal-close" onclick="closeModal('modal-obiettivo')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>KPI Principali</h4>
                <ul>
                    <li><strong>Margine Reale %:</strong> (Ricavo Reale - Costi) / Ricavo Reale</li>
                    <li><strong>Margine Desiderato %:</strong> (Ricavo Teorico - Costi) / Ricavo Teorico</li>
                    <li><strong>Sconto Medio:</strong> quanto "regaliamo" rispetto a tariffa piena</li>
                    <li><strong>Tariffa Oraria Effettiva:</strong> Ricavo Reale / Ore Lavorate</li>
                </ul>

                <h4>Analisi Possibili</h4>
                <ul>
                    <li>Redditività per <strong>cliente</strong>: quali clienti sono profittevoli?</li>
                    <li>Redditività per <strong>tipo incarico</strong>: i bilanci rendono più delle revisioni?</li>
                    <li>Redditività per <strong>team</strong>: quale team è più efficiente?</li>
                    <li>Trend temporale: la redditività sta migliorando o peggiorando?</li>
                    <li>Analisi "what-if": cosa succederebbe se aumentassimo le tariffe del 10%?</li>
                </ul>

                <h4>Esempio di Insight</h4>
                <p>Dall'analisi dei dati emerge che <strong>il 56% degli incarichi è in perdita</strong> (margine reale negativo). Il motivo principale è uno sconto medio del 70% rispetto alla tariffa teorica. Alcuni clienti hanno sconti superiori al 90%!</p>
            </div>
        </div>
    </div>

    <!-- Modal: Dim_Data -->
    <div class="modal-overlay" id="modal-dim-data">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-calendar"></i> Dim_Data - Dimensione Tempo</h3>
                <button class="modal-close" onclick="closeModal('modal-dim-data')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Perché una Dimensione Data?</h4>
                <p>Invece di usare direttamente il campo DATE, creiamo una dimensione dedicata con attributi pre-calcolati. Questo permette di filtrare e raggruppare facilmente per anno, trimestre, mese, settimana senza calcoli runtime.</p>

                <h4>Chiave Surrogata: DataKey</h4>
                <p>Usiamo un intero nel formato <code>YYYYMMDD</code> (es. 20240115 per 15 gennaio 2024). Vantaggi:</p>
                <ul>
                    <li>Join più veloci (integer vs date)</li>
                    <li>Facile partizionamento per anno (DataKey BETWEEN 20240101 AND 20241231)</li>
                    <li>Leggibile anche senza conversione</li>
                </ul>

                <h4>Attributi Disponibili</h4>
                <ul>
                    <li><code>Anno</code>, <code>Trimestre</code>, <code>Mese</code>, <code>Settimana ISO</code></li>
                    <li><code>GiornoSettimanaNum</code> (1=Lunedì, 7=Domenica) - formato italiano!</li>
                    <li><code>GiornoSettimanaNome</code> (Lunedì, Martedì...)</li>
                    <li><code>IsWeekend</code> - flag per escludere sabato/domenica</li>
                    <li><code>MeseNome</code>, <code>MeseBreve</code> - in italiano</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Modal: Dim_Persona -->
    <div class="modal-overlay" id="modal-dim-persona">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-user-clock"></i> Dim_Persona - SCD Type 2</h3>
                <button class="modal-close" onclick="closeModal('modal-dim-persona')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Il Problema</h4>
                <p>Laura Verdi è stata assunta come Senior nel 2012. Nel 2022 è stata promossa a Manager con aumento di stipendio. Nel 2024 è stata trasferita dal team Bilanci al team Revisione. Nel 2025 ha avuto un altro aumento.</p>
                <p><strong>Domanda:</strong> quando calcolo il costo di un suo timesheet del 2023, quale costo uso?</p>

                <h4>La Soluzione: SCD Type 2</h4>
                <p>Invece di una riga per Laura, ne creiamo <strong>5 (una per ogni versione)</strong>:</p>
                <ul>
                    <li>PersonaSK=2001: Senior, Team Bilanci, 2012-2020</li>
                    <li>PersonaSK=2002: Senior, Team Bilanci, 2020-2022</li>
                    <li>PersonaSK=2003: Manager, 48€/ora, Team Bilanci, 2022-2024</li>
                    <li>PersonaSK=2004: Manager, 48€/ora, Team Revisione, 2024-2024</li>
                    <li>PersonaSK=2005: Manager, 52€/ora, Team Revisione, 2025-∞ (IsCorrente=1)</li>
                </ul>

                <h4>Come si Usa</h4>
                <p>Nella Fact_Timesheet, il join non è solo su PersonaID ma anche sulla data:</p>
                <code>WHERE t.Data BETWEEN dp.ValidoDa AND dp.ValidoA</code>
                <p>Così ogni timesheet viene automaticamente collegato alla versione corretta della persona.</p>
            </div>
        </div>
    </div>

    <!-- Modal: Dim_Incarico -->
    <div class="modal-overlay" id="modal-dim-incarico">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-briefcase"></i> Dim_Incarico - Denormalizzata</h3>
                <button class="modal-close" onclick="closeModal('modal-dim-incarico')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Cosa Significa Denormalizzare?</h4>
                <p>Nel database sorgente, l'incarico ha solo <code>ClienteID</code> e <code>TipoIncaricoID</code>. Per vedere il nome del cliente servirebbero 2 join. Nella dimensione, includiamo direttamente:</p>
                <ul>
                    <li><code>ClienteRagioneSociale</code>, <code>ClientePartitaIVA</code>, <code>ClienteSettore</code></li>
                    <li><code>TipoIncaricoDescrizione</code>, <code>TipoIncaricoTeamCompetente</code></li>
                    <li><code>TeamTitolareNome</code></li>
                </ul>

                <h4>Perché?</h4>
                <ul>
                    <li><strong>Semplicità:</strong> l'utente finale non deve conoscere le relazioni</li>
                    <li><strong>Performance:</strong> meno join = query più veloci</li>
                    <li><strong>Self-service BI:</strong> gli utenti di Power BI vedono tutti gli attributi in un posto</li>
                </ul>

                <h4>Trade-off</h4>
                <p>Se il nome del cliente cambia, va aggiornato in tutti gli incarichi. Ma per dati analitici storici, questo raramente è un problema (di solito si vuole il nome che c'era al momento dell'incarico).</p>
            </div>
        </div>
    </div>

    <!-- Modal: Fact_Timesheet -->
    <div class="modal-overlay" id="modal-fact-timesheet">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-clock"></i> Fact_Timesheet - Dettaglio Ore</h3>
                <button class="modal-close" onclick="closeModal('modal-fact-timesheet')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Granularità</h4>
                <p><strong>Una riga = una registrazione di ore</strong> (persona + incarico + data). Questa è la granularità più fine possibile per l'analisi delle ore.</p>

                <h4>Misure Additive</h4>
                <ul>
                    <li><code>OreLavorate</code>: le ore registrate</li>
                    <li><code>CostoEffettivo</code>: Ore × CostoOrario (dalla versione SCD2 corretta)</li>
                    <li><code>RicavoTeoricoRivendita</code>: Ore × TariffaOraria (dalla versione SCD2 corretta)</li>
                    <li><code>MargineTeoricoRivendita</code>: RicavoTeorico - CostoEffettivo</li>
                    <li><code>GiornateEquivalenti</code>: Ore / OreLavorativeGiorno (per analisi FTE)</li>
                </ul>

                <h4>Foreign Keys</h4>
                <ul>
                    <li><code>DataKey</code> → Dim_Data</li>
                    <li><code>PersonaSK</code> → Dim_Persona (versione storica corretta!)</li>
                    <li><code>IncaricoID</code> → Dim_Incarico</li>
                    <li><code>TeamPrestatoreID</code> → Dim_Team (chi ha lavorato)</li>
                    <li><code>TeamTitolareID</code> → Dim_Team (chi possiede l'incarico)</li>
                </ul>

                <h4>Nota sulla Storicizzazione</h4>
                <p>I valori <code>CostoOrario</code> e <code>TariffaOraria</code> sono già "risolti" dal join con Dim_Persona. Non servono calcoli aggiuntivi per ottenere il costo storico corretto.</p>
            </div>
        </div>
    </div>

    <!-- Modal: Fact_Redditivita -->
    <div class="modal-overlay" id="modal-fact-redditivita">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-chart-pie"></i> Fact_Redditivita_Incarico</h3>
                <button class="modal-close" onclick="closeModal('modal-fact-redditivita')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h4>Tipo: Accumulating Snapshot</h4>
                <p>A differenza della Fact_Timesheet (transactional), questa fact table ha <strong>una riga per incarico</strong> che accumula tutti i valori. È utile per analisi a livello incarico senza dover aggregare migliaia di righe timesheet.</p>

                <h4>Misure Chiave</h4>
                <ul>
                    <li><code>RicavoReale</code>: l'importo pattuito con il cliente (forfait)</li>
                    <li><code>RicavoTeorico</code>: somma di (Ore × Tariffa) da tutti i timesheet</li>
                    <li><code>CostoPersonale</code>: somma di (Ore × Costo) da tutti i timesheet</li>
                    <li><code>CostiDiretti</code>: somma delle spese vive</li>
                    <li><code>MargineReale</code>: RicavoReale - CostoPersonale - CostiDiretti</li>
                    <li><code>MargineDesiderato</code>: RicavoTeorico - CostoPersonale - CostiDiretti</li>
                </ul>

                <h4>Percentuali e Indicatori</h4>
                <ul>
                    <li><code>MargineRealePerc</code>: margine reale in percentuale</li>
                    <li><code>ScontoApplicatoPerc</code>: quanto abbiamo scontato rispetto a tariffa piena</li>
                    <li><code>TariffaOrariaEffettiva</code>: RicavoReale / TotaleOre</li>
                    <li><code>AvanzamentoPerc</code>: percentuale completamento capitolato</li>
                </ul>

                <h4>Perché Due Fact Table?</h4>
                <p>Non possiamo mettere <code>RicavoReale</code> nella Fact_Timesheet perché violerebbe la granularità. L'importo pattuito è a livello incarico, non a livello singola ora. Kimball insegna: <strong>mai violare la granularità</strong>!</p>
            </div>
        </div>
    </div>

    <script>
        // Modal functions
        function openModal(id) {
            document.getElementById(id).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
            document.body.style.overflow = '';
        }

        // Close modal on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });
        });

        // Close modal on ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal-overlay.active').forEach(m => {
                    m.classList.remove('active');
                });
                document.body.style.overflow = '';
            }
        });

        // Tabs
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // Reveal on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

        // Smooth scroll for nav links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>

</body>
</html>
